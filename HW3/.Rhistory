bonda2-bonda
changea2=(bonda2-bonda)/bonda
changea2 = round(100*changea2, 2)
changea2
bondb2 = 0
for(i in c(1:19)){
bondb2=bondb2+couponb/(1.016^i)
}
bondb2=bondb2+(couponb+100)/(1.016^20)
bondb2
bondb2-bondb
changeb2=(bondb2-bondb)/bondb
changeb2=round(100*changeb2, 2)
changeb2
bondc2 = 0
for(i in c(1:9)){
bondc2=bondc2+couponc/(1.016^i)
}
bondc2=bondc2+(couponc+100)/(1.016^10)
bondc2
bondc2-bondc
changec2=(bondc2-bondc)/bondc
changec2=round(100*changec2, 2)
changec2
bondd2 = 0
for(i in c(1:19)){
bondd2=bondd2+coupond/(1.016^i)
}
bondd2=bondd2+(coupond+100)/(1.016^20)
bondd2
bondd2-bondd
changed2=(bondd2-bondd)/bondd
changed2=round(100*changed2, 2)
changed2
# Problem e
# Duration when the yield is 3.5%
PeriodA=0
for(i in c(1:9)){
PeriodA=PeriodA+i*coupona/(1.0175^i)
}
durationa=(PeriodA+5*(coupona+100)/(1.0175^10))/bonda
durationa=durationa/1.035
durationa
PeriodB=0
for(i in c(1:19)){
PeriodB=PeriodB+i*couponb/(1.0175^i)
}
durationb=(PeriodB+10*(couponb+100)/(1.0175^20))/bondb
durationb=durationb/1.0175
durationb
PeriodC=0
for(i in c(1:9)){
PeriodC=PeriodC+i*couponc/(1.0175^i)
}
durationc=(PeriodC+5*(couponc+100)/(1.035^10))/bondc
durationc=durationc/1.035
durationc
PeriodD=0
for(i in c(1:19)){
PeriodD=PeriodD+i*coupond/(1.0175^i)
}
durationd=(PeriodD+10*(coupond+100)/(1.035^20))/bondd
durationd=durationd/1.0175
durationd
# price changes for 3.5->3.8 yld chg
eua=-0.003*durationa*bonda
eub=-0.003*durationb*bondb
euc=-0.003*durationc*bondc
eud=-0.003*durationd*bondd
eua
eub
euc
eud
#price changes for 3.5->3.2 yld chg
eda=0.003*durationa*bonda
edb=0.003*durationb*bondb
edc=0.003*durationc*bondc
edd=0.003*durationd*bondd
eda
edb
edc
edd
bonda2 = 0
for(i in c(1:9)){
bonda2=bonda2+coupona/(1.016^i)
}
bonda2=bonda2+(coupona+100)/(1.016^10)
bonda2
bonda2-bonda
changea2=(bonda2-bonda)/bonda
changea2 = round(100*changea2, 2)
changea2
bondb2 = 0
for(i in c(1:19)){
bondb2=bondb2+couponb/(1.016^i)
}
bondb2=bondb2+(couponb+100)/(1.016^20)
bondb2
bondb2-bondb
changeb2=(bondb2-bondb)/bondb
changeb2=round(100*changeb2, 2)
changeb2
bondc2 = 0
for(i in c(1:9)){
bondc2=bondc2+couponc/(1.016^i)
}
bondc2=bondc2+(couponc+100)/(1.016^10)
bondc2
bondc2-bondc
changec2=(bondc2-bondc)/bondc
changec2=round(100*changec2, 2)
changec2
bondd2 = 0
for(i in c(1:19)){
bondd2=bondd2+coupond/(1.016^i)
}
bondd2=bondd2+(coupond+100)/(1.016^20)
bondd2
bondd2-bondd
changed2=(bondd2-bondd)/bondd
changed2=round(100*changed2, 2)
changed2
# Problem e
# Duration when the yield is 3.5%
PeriodA=0
for(i in c(1:9)){
PeriodA=PeriodA+i*coupona/(1.0175^i)
}
durationa=(PeriodA+5*(coupona+100)/(1.0175^10))/bonda
durationa=durationa/1.035
durationa
PeriodB=0
for(i in c(1:19)){
PeriodB=PeriodB+i*couponb/(1.0175^i)
}
durationb=(PeriodB+10*(couponb+100)/(1.0175^20))/bondb
durationb=durationb/1.0175
durationb
PeriodC=0
for(i in c(1:9)){
PeriodC=PeriodC+i*couponc/(1.0175^i)
}
durationc=(PeriodC+5*(couponc+100)/(1.035^10))/bondc
durationc=durationc/1.035
durationc
PeriodD=0
for(i in c(1:19)){
PeriodD=PeriodD+i*coupond/(1.0175^i)
}
durationd=(PeriodD+10*(coupond+100)/(1.035^20))/bondd
durationd=durationd/1.0175
durationd
coupona=0.01/2*100
couponb=0.01/2*100
couponc=0.04/2*100
coupond=0.04/2*100
bonda = 0
for(i in c(1:9)){
bonda=bonda+coupona/(1.0175^i)
}
bonda=bonda+(coupona+100)/(1.0175^10)
bonda
bondb = 0
for(i in c(1:19)){
bondb=bondb+couponb/(1.0175^i)
}
bondb=bondb+(couponb+100)/(1.0175^20)
bondb
bondc = 0
for(i in c(1:9)){
bondc=bondc+couponc/(1.0175^i)
}
bondc=bondc+(couponc+100)/(1.0175^10)
bondc
bondd = 0
for(i in c(1:19)){
bondd=bondd+coupond/(1.0175^i)
}
bondd=bondd+(coupond+100)/(1.0175^20)
bondd
# Problem c
bonda1 = 0
for(i in c(1:9)){
bonda1=bonda1+coupona/(1.019^i)
}
bonda1=bonda1+(coupona+100)/(1.019^10)
bonda1
bonda1-bonda
changea1=(bonda1-bonda)/bonda
changea1 = round(100*changea1, 2)
changea1
bondb1 = 0
for(i in c(1:19)){
bondb1=bondb1+couponb/(1.019^i)
}
bondb1=bondb1+(couponb+100)/(1.019^20)
bondb1
bondb1-bondb
changeb1=(bondb1-bondb)/bondb
changeb1=round(100*changeb1, 2)
changeb1
bondc1 = 0
for(i in c(1:9)){
bondc1=bondc1+couponc/(1.038^i)
}
bondc1=bondc1+(couponc+100)/(1.019^10)
bondc1
bondc1-bondc
changec1=(bondc1-bondc)/bondc
changec1=round(100*changec1, 2)
changec1
bondd1 = 0
for(i in c(1:19)){
bondd1=bondd1+coupond/(1.019^i)
}
bondd1=bondd1+(coupond+100)/(1.019^20)
bondd1
bondd1-bondd
changed1=(bondd1-bondd)/bondd
changed1=round(100*changed1, 2)
changed1
# Problem d
bonda2 = 0
for(i in c(1:9)){
bonda2=bonda2+coupona/(1.016^i)
}
bonda2=bonda2+(coupona+100)/(1.016^10)
bonda2
bonda2-bonda
changea2=(bonda2-bonda)/bonda
changea2 = round(100*changea2, 2)
changea2
bondb2 = 0
for(i in c(1:19)){
bondb2=bondb2+couponb/(1.016^i)
}
bondb2=bondb2+(couponb+100)/(1.016^20)
bondb2
bondb2-bondb
changeb2=(bondb2-bondb)/bondb
changeb2=round(100*changeb2, 2)
changeb2
bondc2 = 0
for(i in c(1:9)){
bondc2=bondc2+couponc/(1.016^i)
}
bondc2=bondc2+(couponc+100)/(1.016^10)
bondc2
bondc2-bondc
changec2=(bondc2-bondc)/bondc
changec2=round(100*changec2, 2)
changec2
bondd2 = 0
for(i in c(1:19)){
bondd2=bondd2+coupond/(1.016^i)
}
bondd2=bondd2+(coupond+100)/(1.016^20)
bondd2
bondd2-bondd
changed2=(bondd2-bondd)/bondd
changed2=round(100*changed2, 2)
changed2
# Problem e
# Duration when the yield is 3.5%
PeriodA=0
for(i in c(1:9)){
PeriodA=PeriodA+i*coupona/(1.0175^i)
}
durationa=(PeriodA+5*(coupona+100)/(1.0175^10))/bonda
durationa=durationa/1.035
durationa
PeriodB=0
for(i in c(1:19)){
PeriodB=PeriodB+i*couponb/(1.0175^i)
}
durationb=(PeriodB+10*(couponb+100)/(1.0175^20))/bondb
durationb=durationb/1.0175
durationb
PeriodC=0
for(i in c(1:9)){
PeriodC=PeriodC+i*couponc/(1.0175^i)
}
durationc=(PeriodC+5*(couponc+100)/(1.035^10))/bondc
durationc=durationc/1.035
durationc
PeriodD=0
for(i in c(1:19)){
PeriodD=PeriodD+i*coupond/(1.0175^i)
}
durationd=(PeriodD+10*(coupond+100)/(1.035^20))/bondd
durationd=durationd/1.0175
durationd
PeriodA=0
for(i in c(1:9)){
PeriodA=PeriodA+i*coupona/(1.0175^i)
}
durationa=(PeriodA+5*(coupona+100)/(1.0175^10))/bonda
durationa=durationa/1.0175
durationa
PeriodB=0
for(i in c(1:19)){
PeriodB=PeriodB+i*couponb/(1.0175^i)
}
durationb=(PeriodB+10*(couponb+100)/(1.0175^20))/bondb
durationb=durationb/1.0175
durationb
PeriodC=0
for(i in c(1:9)){
PeriodC=PeriodC+i*couponc/(1.0175^i)
}
durationc=(PeriodC+5*(couponc+100)/(1.0175^10))/bondc
durationc=durationc/1.0175
durationc
PeriodD=0
for(i in c(1:19)){
PeriodD=PeriodD+i*coupond/(1.0175^i)
}
durationd=(PeriodD+10*(coupond+100)/(1.0175^20))/bondd
durationd=durationd/1.0175
durationd
for(i in c(1:9)){
bondc1=bondc1+couponc/(1.019^i)
}
bondc1=bondc1+(couponc+100)/(1.019^10)
bondc1
bondc1-bondc
changec1=(bondc1-bondc)/bondc
changec1=round(100*changec1, 2)
changec1
for(i in c(1:9)){
bondc1=bondc1+couponc/(1.019^i)
}
bondc1 = 0
for(i in c(1:9)){
bondc1=bondc1+couponc/(1.019^i)
}
bondc1=bondc1+(couponc+100)/(1.019^10)
bondc1
bonda2
PeriodA=0
for(i in c(1:9)){
PeriodA=PeriodA+i*coupona/(1.0175^(i+1))
}
durationa=(PeriodA+(10*(coupona+100)/(1.0175^11)))/bonda
durationa=durationa/1.0175
durationa
PeriodB=0
for(i in c(1:19)){
PeriodB=PeriodB+i*couponb/(1.0175^i)
}
durationb=(PeriodB+(20*(couponb+100)/(1.0175^21)))/bondb
durationb=durationb/1.0175
durationb
PeriodC=0
for(i in c(1:9)){
PeriodC=PeriodC+i*couponc/(1.0175^i)
}
durationc=(PeriodC+(10*(couponc+100)/(1.0175^11)))/bondc
durationc=durationc/1.0175
durationc
PeriodD=0
for(i in c(1:19)){
PeriodD=PeriodD+i*coupond/(1.0175^i)
}
durationd=(PeriodD+(20*(coupond+100)/(1.0175^21)))/bondd
durationd=durationd/1.0175
durationd
# Problem Set 3 Solution Template
# mysoln is a list to store your answers
# the first element of the list is a vector of names for the students in your group
# make sure these match the names shown on the pdf document provided by the MFE office
# using group 1 as an example:
mysoln = list(student = c("Huanyu Liu", "Hyeuk Jung", "Jiaqi Li", "Xichen Luo"))
# 1
# your intermediary code to get your answers here
# 1. (a)
library(FinancialMath)
price = 10/(1+0.05) + 10/(1+0.055)^2 + 110/(1+0.065)^3
ytm = IRR(cf0 = price, cf = c(10,10,110), times = c(1,2,3))
price; ytm
# 1. (b)
forward_1_1 = ((1.055)^2 / 1.05) - 1
forward_1_2 = sqrt((1.065)^3 / 1.05) - 1
forward_2_1 = ((1.065)^3 / (1.055)^2) - 1
forward_1_1; forward_1_2; forward_2_1
# 1. (c)
# Roll over the investment. That being said;
# Method 1. we can exploit r1, 1f1, 2f1 in each period.
price_1_c_fv_1 = 10*(1+forward_1_1)*(1+forward_2_1) + 10*(1+forward_2_1) + 110
return.3yr_1 = (price_1_c_fv_1/price)^(1/3) - 1
return.3yr_1
# Method 2. reinvest year 1's coupon with 1f2 and the year 2's coupon with 2f1
price_1_c_fv2 = 10*(1+forward_1_2)^2 + 10*(1+forward_2_1) + 110
return.3yr2 = (price_1_c_fv2/price)^(1/3) - 1
return.3yr2
# save down your final answers for part a, b, and c
a = c(price, ytm)
b = c(forward_1_1,forward_1_2,forward_2_1) #increase/decrease vector depending on how many forward rates you can calculate
c = return.3yr
# add answers to list for "Q2"
mysoln[["Q1"]] = list(a=a, b=b, c=c)
# 2
# put a and c in pdf
# Forward rate
b=round(sqrt((1+0.07)^3/(1+0.06))-1,2)
mysoln[["Q2"]] = list(b=b)
# 3
# your intermediary code to get your answers here
PV <- function(par, coupon, period, yield){
PV = 0
for(i in 1:period){
PV = PV + (coupon / (1 + yield)^i)
}
PV = PV + (par / (1 + yield)^(period))
return(PV)
}
#bond A
PA = PV(100,0.5,10,0.0175)
DA = 0
for (t in 1:9)
{
DA = DA + 0.5/(1.0175^t)/PA*t
}
DA = DA + 100.5/(1.0175^10)/PA*10/2
DA_modified = DA/1.0175
#bond B
PB = PV(100,0.5,20,0.0175)
DB = 0
for (t in 1:19)
{
DB = DB + 0.5/(1.0175^t)/PB*t
}
DB = DB + 100.5/(1.0175^20)/PB*20/2
DB_modified = DB/1.0175
#bond C
PC = PV(100,2,10,0.0175)
DC = 0
for (t in 1:9)
{
DC = DC + 2/(1.0175^t)/PC*t
}
DC = DC + 102/(1.0175^10)/PC*10/2
DC_modified = DC/1.0175
#bond D
PD = PV(100,2,20,0.0175)
DD = 0
for (t in 1:19)
{
DD = DD + 2/(1.0175^t)/PD*t
}
DD = DD + 102/(1.0175^20)/PD*20/2
DD_modified = DD/1.0175
INchangeA = -0.003*DA_modified*PA
INchangeB = -0.003*DB_modified*PB
INchangeC = -0.003*DC_modified*PC
INchangeD = -0.003*DD_modified*PD
DEchangeA = 0.003*DA_modified*PA
DEchangeB = 0.003*DB_modified*PB
DEchangeC = 0.003*DC_modified*PC
DEchangeD = 0.003*DD_modified*PD
# save down your final answers for part b,c,d,and e (a and f in PDF writeup)
#a = "Put in PDF Write Up"
b = c(0,0,0,0) #(Bond A, Bond B, Bond C, Bond D)
c.prices = c(0,0,0,0) #(Bond A, Bond B, Bond C, Bond D)
c.changes = c(0.01,0.01,0.01,0.01) #(Bond A % Chg, Bond B % Chg, Bond C % Chg, Bond D % Chg) in decimal form
d.prices = c(0,0,0,0) #(Bond A, Bond B, Bond C, Bond D)
d.changes = c(0.01,0.01,0.01,0.01) #(Bond A % Chg, Bond B % Chg, Bond C % Chg, Bond D % Chg) in decimal form
e = c(0,0,0,0) #(Bond A duration, Bond B duration, Bond C duration, Bond D duration)
eu = c(0,0,0,0) # price changes for 3.0->3.5 yld chg
ed = c(0,0,0,0) # price changes for 3.0->2.5 yld chg
#f = "Put in PDF Write up"
# add answers to list for "Q2"
mysoln[["Q3"]] = list(#a=a, put in PDF writeup only
b=b,
c.pric = c.prices,
c.chg = c.changes, #changes are percent changes in decimal
d.pric = d.prices,
d.chg = d.changes, #changes are percent changes in decimal
e = e,
eu = eu,
ed = ed)
#f = f put in PDF writeup only
# 4
# your intermediary code to get your answers here
bondA.weight = 2000000 / 100
A = matrix(data=c(4, 6, 104, 106), nrow=2, ncol=2, byrow=TRUE)
b = matrix(data=c(0,1000000),nrow=2, ncol=1, byrow=FALSE)
b.and.c = solve(A, b)
bondB.weight = b.and.c[1]
bondC.weight = b.and.c[2]
# answers
# Note: Remember to add conclusions in write-up
discount = 1 + 0.06
price.D = 100 / discount^10
price.E = 100 / discount^15
liability = 1000000 / discount^30 + 2000000 / discount^31
weight.D = price.D / liability
weight.E = price.E / liability
liability_duration = 1000000/discount^30 / liability * 30 + 2000000/discount^31 / liability * 31
A = matrix(data = c(10 * weight.D, 15 * weight.E, price.D, price.E), nrow = 2, ncol = 2, byrow = TRUE)
b = matrix(data = c(liability_duration, liability), nrow = 2, ncol = 1, byrow = FALSE)
D.and.E = solve(A,b)
bondD.weight = D.and.E[1]
bondE.weight = D.and.E[2]
a = c(bondA.weight, bondB.weight, bondC.weight)
b = c(bondD.weight, bondE.weight)
#c = "Put in PDF writeup"
#d = "Put in PDF writeup"
# add answers to list for "Q4"
mysoln[["Q4"]] =  list(a=a, b=b) #c and d in writeup
# return my solution
mysoln
